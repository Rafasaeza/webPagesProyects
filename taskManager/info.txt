#Para que podamos coger la imagen creada de docker necesitamos subirla al repositorio
#Para ello creamos la imagen como
docker build -t rafasaez/nombre-repositorio
#luego mandamos la imagen a docker hub
docker push rafasaez/nombre-repositorio

#objecto secreto
apiVersion: v1
kind: Secret
metadata:
  name: mysql-secret
type: Opaque
data:
  #En base64 ponemos nuestra contraseña encriptada
  password: base64_encoded_passwordecho 

#Para encriptar se encripta en base64 por default al usar secret
echo -n 'your_password' | base64 


#para iteractuar con la base de datos
kubectl exec -i mysql-0 -n z2  -- mysql -h mysql-service.z2.svc.cluster.local -P80 -u root -p password < sql/script.sql


#problemas
#Cuando añado la informacion de los volumenes de la configuracion inicial no funciona el state ful set
#en volumemounts
 - name: init-scripts
          mountPath: /docker-entrypoint-initdb.d
 volumeClaimTemplates:
  - metadata:
      name: init-scripts
    spec:
      accessModes: [ "ReadWriteOnce" ]
      resources:
        requests:
          storage: 1Gi


#Funciona la app finalmente obte por meter la config de la base de datos directamente en el docker file para crear una nueva imagen de sql con la base configurada
#Volver a hacer lo de la ssh key 

#Conectar a la base de datos
#kubectl exec -it -n z2  mysql-0 -- mysql -u root -p notas
#Solo me deja entrar a mysql cuando ejecuto el comando de arriba
#Cuando hago delete namespace no se me guarda la informacion que tengo en la base de datos

#cambiar a retain
kubectl patch pv <pv-name> -p '{"spec":{"persistentVolumeReclaimPolicy":"Retain"}}'